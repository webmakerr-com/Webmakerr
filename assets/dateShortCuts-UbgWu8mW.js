var pI=Object.defineProperty;var dI=(r,e,t)=>e in r?pI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ai=(r,e,t)=>dI(r,typeof e!="symbol"?e+"":e,t);import{i as wr,j as vg,R as cf,u as Va,c as ue,d as Ae,w as Tr,a as Ga,o as jt,f as _e,F as Cs,h as Hu,n as pf,t as As,U as gI,g as Lw,H as yI,p as Pw,e as Wu,l as mI,q as _I,S as SI,r as bm,b as Ew,K as xI,D as bI,Y as wI}from"./vue.esm-bundler-DZdE0M9V.js";import{t as Se,A as TI}from"./Translator-Bios5QX5.js";import{C as CI}from"./index-C83b7x36.js";import{I as AI,S as DI}from"./Badge-CAEsoWyQ.js";import{_ as df}from"./DynamicIcon-D-LZibaK.js";import{ab as MI}from"./index-DwF99AZu.js";import"./Rest-DEQMhckH.js";import{A as II}from"./Arr-MwYQQ3qa.js";import{F as LI,b as PI}from"./RouteCell-CQByaDWH.js";import{g as EI,d as Ut}from"./dayjs.min-2rai63wT.js";const RI={class:"el_pop_data_group"},kI={class:"el_pop_data_headings"},OI=["data-item_index","onClick"],NI={class:"el_pop_data_body"},BI=["onClick"],VI=Object.assign({name:"inputPopoverDropdownExtended"},{__name:"input-popover-dropdown",props:{data:Array,close_on_insert:{type:Boolean,default(){return!0}},btnType:{type:String,default(){return"success"}},btnSize:{type:String,default:""},plain:{type:Boolean,default(){return!1}},placement:{type:String,default:"top"}},emits:["command"],setup(r,{emit:e}){const t=r,a=wr(),n=wr(!1),i=wr(""),o=e,s=wr(""),l=()=>{n.value=!1},u=h=>{o("command",h),t.close_on_insert&&(n.value=!1)},f=h=>{if(!i.value.trim())return h;const v=i.value.toLowerCase().trim(),c={};return Object.entries(h).forEach(([p,d])=>{(d.toLowerCase().includes(v)||p.toLowerCase().includes(v))&&(c[p]=d)}),c};return vg(()=>{s.value=Object.keys(t.data)[0]}),(h,v)=>{const c=Ga("el-input"),p=Ga("el-button"),d=Ga("el-popover");return cf((jt(),ue("div",null,[Ae(d,{ref_key:"popoverRef",ref:a,placement:r.placement,width:500,trigger:"click","popper-class":"fct-input-dropdown-popover-wrap","show-arrow":!0,visible:n.value,teleported:!1},{reference:Tr(()=>[Ae(p,{onClick:v[1]||(v[1]=g=>n.value=!n.value),class:"editor-add-shortcode",type:r.btnType,plain:r.plain,size:r.btnSize},{default:Tr(()=>v[2]||(v[2]=[Lw(" {{:}} ",-1)])),_:1,__:[2]},8,["type","plain","size"])]),default:Tr(()=>[_e("div",RI,[_e("div",kI,[_e("ul",null,[(jt(!0),ue(Cs,null,Hu(r.data,(g,y)=>(jt(),ue("li",{key:y,"data-item_index":y,class:pf(s.value==y?"item_selected":""),onClick:m=>s.value=y},As(g.title),11,OI))),128))])]),_e("div",NI,[Ae(c,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=g=>i.value=g),class:"sticky top-0 bg-white dark:bg-primary-600",placeholder:Va(Se)("Search"),clearable:""},null,8,["modelValue","placeholder"]),(jt(!0),ue(Cs,null,Hu(r.data,(g,y)=>cf((jt(),ue("ul",{key:y,class:pf("el_pop_body_item_"+y)},[(jt(!0),ue(Cs,null,Hu(f(g.shortcodes),(m,_,S)=>(jt(),ue("li",{onClick:b=>u(_),key:S},[_e("span",null,As(m),1),_e("span",null,As(_),1)],8,BI))),128))],2)),[[gI,s.value==y]])),128))])])]),_:1},8,["placement","visible"])])),[[Va(CI),l]])}}});function zI(){const r=`${fluentCartRestVars.rest.url}/upload-editor-file`,e=window.fluentCartRestVars.rest.nonce,t=yI({uploadingFile:!1,uploadProgress:0});let a=null,n;function i(f){a=f,a.on("paste",function(h){const v=h.clipboardData.files[0];v&&(h.preventDefault(),o(v))})}function o(f){f!==null&&(t.uploadingFile=!0,t.uploadProgress=0,s(u(f)))}function s(f){jQuery.ajax({type:"POST",url:r,data:f,contentType:!1,processData:!1,xhr:function(){return n=new window.XMLHttpRequest,n.upload.addEventListener("progress",function(h){h.lengthComputable&&(t.uploadProgress=h.loaded/h.total*100)},!1),n},error:()=>{t.uploadingFile=!1,t.uploadProgress=0},success:h=>{if(h){let v=`&#160<img src="${h.url}" alt="${h.title}" width="300" height="200" class="alignnone size-medium wp-image-${h.id}"/>&#160`;a.insertContent(v)}t.uploadingFile=!1,t.uploadProgress=0}})}function l(){n!=null&&(n.abort(),n=null)}function u(f){const h=new FormData;return h.append("file",f),h.append("X-WP-Nonce",e),h}return{state:t,init:i,cancelUploading:l}}function FI(){let r,e,t,a;function n(f,h,v){r=f;let c=jQuery(`#${h}`);if(a=v??250,e=jQuery(c).parents()[0],jQuery(e).css({resize:"vertical","overflow-y":"auto","min-height":`${a}px`,height:`${a}px`}),!r||!r.contentAreaContainer){setTimeout(()=>n(f,h,v),100);return}o(),l(e)}function i(){const f=e.offsetHeight,h=jQuery(e).find(".mce-toolbar-grp").outerHeight(!0)||0,v=jQuery(e).find(".mce-statusbar").outerHeight(!0)||0,c=h+v+10,p=f-c;return Math.max(a-c,p)}function o(){if(!r||!r.contentAreaContainer)return;const f=i(),h=r.contentAreaContainer.offsetHeight;Math.abs(f-h)>2&&(r.contentAreaContainer.style.height=`${f}px`,r.theme&&r.theme.resizeTo&&r.theme.resizeTo(null,f)),f+s()<a&&jQuery(e).css("height",`${a}px`)}function s(){const f=jQuery(e).find(".mce-toolbar-grp").outerHeight(!0)||0,h=jQuery(e).find(".mce-statusbar").outerHeight(!0)||0;return f+h+10}function l(f){t=new ResizeObserver(()=>{o()}),t.observe(f)}function u(){t&&e&&t.unobserve(e)}return{init:n,destroy:u}}const GI={key:0},f9={__name:"MediaButton",props:{multiple:!1,iconMode:!1,attachments:{type:Array,default:()=>[]},title:{default:Se("Add Media")},action_title:{default:Se("Use This Media")},icon:{default:"GalleryAdd"},libraryType:{default:"image"}},emits:["onMediaSelected"],setup(r,{expose:e,emit:t}){const a=r;let n=[],i=null;const o=t,s=()=>{i!=null&&i.open()};e({openMediaFrame:s}),vg(()=>{!typeof window.wp.media!=="function"&&(wp.media.view.Modal=wp.media.view.Modal.extend({className:"wp-fluent-media-modal"}),u(),i=window.wp.media({title:Se("Select or Upload Media"),button:{text:a.action_title},library:{type:a.libraryType},multiple:a.multiple?"add":!1,is_button:a.is_button}),f(),h())});const l=v=>/^\d+$/.test(v),u=()=>{n=[],Array.isArray(a.attachments)&&a.attachments.length>0&&Object.values(a.attachments).forEach((v,c)=>{l(v.id)&&n.push(v.id)})},f=()=>{i.on("open",function(){let v=i.state().get("selection");n.forEach(function(c){let p=window.wp.media.attachment(c);p&&v.add(p)})})},h=()=>{i.on("select",function(){const v=i.state().get("selection").toJSON();o("onMediaSelected",v)})};return Pw(()=>a.attachments,(v,c)=>{u()}),(v,c)=>r.iconMode?(jt(),ue("div",{key:1,onClick:s},[Ae(df,{name:"Edit"})])):(jt(),ue("div",{key:0,class:"fct-media-button",onClick:s},[Ae(df,{name:r.icon},null,8,["name"]),r.title?(jt(),ue("span",GI,As(r.title),1)):Wu("",!0)]))}},HI={"bg-neutral-lite":"#F6F7FA",neutral:{50:"#F8F9FC",100:"#EEEFF1",200:"#DADDE7",300:"#F1F2F8",400:"#E8EAF1",500:"#E3E6EF",600:"#DEE1EB",700:"#CDD0DA",800:"#C9CBCF",900:"#A0A1A7",1e3:"#868A98",1100:"#666978",1200:"#1B1F35"},secondary:{25:"#F8F5FE",50:"#F0ECFD",100:"#E1D8FB",200:"#C4B1F7",300:"#A68AF3",400:"#8963EF",500:"#6B3CEB",600:"#6036D4",700:"#5630BC",800:"#4B2AA5"},gray:{25:"#F9FAFB",50:"#F5F6F7",100:"#EAECF0",200:"#D6DAE1",300:"#C1C7D1",400:"#ADB5C2",500:"#98A2B3",600:"#8E99AA",700:"#808B9C",800:"#758195",outline:"#D6DAE1",divider:"#EAECF0",neutral:"#FAFAFA"},blue:{25:"#F2F9FE",50:"#E6F2FE",100:"#CCE5FD",200:"#99CBFA",300:"#67B2F8",400:"#3498F5",500:"#017EF3",600:"#0171DB",700:"#0165C2",800:"#0158AA"},primary:{25:"#F0F0F1",50:"#D9DADC",100:"#C0C2C4",200:"#8D9095",300:"#5A5F66",400:"#2C3C4E",500:"#253241",600:"#1C2732",700:"#151D26",800:"#11171D"},success:{25:"#F3FAF8",50:"#E8F5F1",100:"#D1EAE4",200:"#A3D6C9",300:"#74C1AD",400:"#46AD92",500:"#189877",600:"#16896B",700:"#137A5F",800:"#116A53"},warning:{25:"#FFF9F3",50:"#FEF4E6",100:"#FDE8CD",200:"#FBD29C",300:"#F9BB6A",400:"#F7A539",500:"#F58E07",600:"#DC8006",700:"#C47206",800:"#AC6305",dark:"#71330A",base:"#FA7319",light:"#FFD9C0",lighter:"#FFF3EB","dark-dark":"#FFA468","base-dark":"#E16614","light-dark":"#FA73193D","lighter-dark":"#FA731929"},red:{25:"#FDF5F3",50:"#FCEBE6",100:"#F8D6CE",200:"#F1AE9D",300:"#EB856B",400:"#E45D3A",500:"#F04438",600:"#C72F08",700:"#B12A07",800:"#9B2406"},dark:{25:"#F0F0F1",50:"#D9DADC",100:"#C0C2C4",200:"#8D9095",300:"#5A5F66",400:"#2C3C4E",500:"#253241",600:"#1C2732",700:"#151D26",800:"#11171D"},system:{dark:"#2F3448",mid:"#565865","dark-light":"#696778",light:"#9D9FAC"},report:{royal_blue:"#4D6EF5",medium_turquoise:"#33D3BB",hot_pink:"#FB4BA3",deep_sky_blue:"#47C2FF",medium_slate_blue:"#855EF8",golden_rod:"#F6B51E",sea_green:"#23A682",coral:"#FF8447",purple:"#8C71F6",cyan_blue:"#B8D4E7",cyan_blue_dark:"#9EC2DE",light_gray:"#EAF0F4",light_gray_cyan_blue:"#A7C1D2",light_gray_blue:"#E3E9F5",dark_blue:"#1436FF",dark_purple:"#6733FC",blue:"#6895FF",dark_cyan_blue_16:"#47C2FF29",dark_cyan_blue_24:"#47C2FF3D",dark_cyan_blue_36:"#47c2ff66",dark_cyan_blue_40:"#47C2FF66",purple_dark_mode:"#9175FF",blue_dark_mode:"#6F8CFF"},information:{dark:"#122368",base:"#335CFF",light:"#C0D5FF",lighter:"#EBF1FF","dark-dark":"#6895FF","base-dark":"#335CFF","light-dark":"#476CFF3D","lighter-dark":"#476CFF29"},feature:{dark:"#351A75",base:"#7D52F4",light:"#CAC0FF",lighter:"#EFEBFF","dark-dark":"#8C71F6","base-dark":"#7D52F4","light-dark":"#784DEF3D","lighter-dark":"#784DEF29"},highlighted:{dark:"#68123D",base:"#FB4BA3",light:"#FFC0DF",lighter:"#FFEBF4","dark-dark":"#FF68B3","base-dark":"#FB4BA3","light-dark":"#FB4BA33D","lighter-dark":"#FB4BA329"}},$e=class $e{static get colors(){return HI}static getSystemTheme(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?this.MODE_DARK:this.MODE_LIGHT}static getCurrentTheme(){return[this.MODE_LIGHT,this.MODE_DARK,this.MODE_SYSTEM].includes(this.getSavedTheme())?this.getSavedTheme().toString():this.MODE_SYSTEM}static getSavedTheme(){return localStorage.getItem("fcart_admin_theme")}static isDark(){return this.isSystem()?this.getSystemTheme()===this.MODE_DARK:this.getCurrentTheme()===this.MODE_DARK}static isLight(){return this.isSystem()?this.getSystemTheme()===this.MODE_LIGHT:this.getCurrentTheme()===this.MODE_LIGHT}static isSystem(){return this.getCurrentTheme().startsWith(this.MODE_SYSTEM)}static toggle(){const e=this.isLight()?this.MODE_DARK:this.MODE_LIGHT;return this.apply(e),e}static apply(e,t={}){const a=e;e===this.MODE_SYSTEM&&(e=this.getSystemTheme());const n=[document.querySelector("#wpbody-content"),document.querySelector(".wp-toolbar"),document.body,document.querySelector("#wpfooter")].filter(Boolean);e===this.MODE_DARK?n.forEach(i=>i.classList.add("dark")):n.forEach(i=>i.classList.remove("dark")),a===$e.MODE_SYSTEM?this.saveThemePreference(`${a}:${e}`):this.saveThemePreference(a),this.dispatchThemeChangeEvent(e,t)}static dispatchThemeChangeEvent(e,t){t.theme=e,window.dispatchEvent(new CustomEvent(this.THEME_CHANGE_EVENT,{detail:t}))}static isAdminBarEnabled(){return II.get(window,"fluentCartAdminApp.is_admin_bar_showing",!1)}static saveThemePreference(e){localStorage.setItem("fcart_admin_theme",e)}static addDarkClass(e){e&&this.isDark()&&e.classList.add("dark")}static removeDarkClass(e){e&&e.classList.remove("dark")}static toggleDarkClass(e){e&&e.classList.toggle("dark")}listenForThemeChange(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{$e.isSystem()&&$e.apply($e.MODE_SYSTEM)})}init(){this.listenForThemeChange(),$e.apply($e.getCurrentTheme())}};Ai($e,"MODE_LIGHT","light"),Ai($e,"MODE_DARK","dark"),Ai($e,"MODE_SYSTEM","system"),Ai($e,"THEME_CHANGE_EVENT","onFluentCartThemeChange"),Ai($e,"THEME_TOGGLE_EVENT","changeFluentCartTheme");let gf=$e;new gf().init();const WI=["innerHTML"],UI={class:"relative w-full"},YI={class:"top-1 absolute w-[calc(100%-128px)] left-0 flex gap-2 justify-between pb-0 z-[9]"},$I={key:0,class:"flex gap-2 flex-row"},XI={class:"fct-add-shortcode-button-wrap"},ZI={class:"flex gap-2 items-center ml-auto"},qI={key:0,class:"w-full"},KI={class:"custom-wp-editor-wrapper"},QI=["id","value"],jI={key:0},JI={key:1},h9={__name:"WpEditor",props:{editor_id:{type:String,default(){return"wp_editor_"+Date.now()+parseInt((Math.random()*1e3).toString())}},shortCodes:{default:{}},buttons:{default:{}},templates:{default:{}},emailTemplateEditor:!1,height:{type:Number,default(){return 250}},modelValue:{type:String,default:""}},emits:["update","onEditorReady","getTemplate"],setup(r,{expose:e,emit:t}){mI().ctx;const a=wr(!1),n=wr(null);wr(null);const{state:i,init:o,cancelUploading:s}=zI(),{init:l}=FI(),u=r,f=wr(u.modelValue.length),h=wr(u.modelValue),v=wr();vg(function(){window.wp.editor&&(a.value=!0,_I(function(){setTimeout(function(){g(),window.addEventListener("onFluentCartThemeChange",C=>{g()},!1)},200)}))});const c=t,p=()=>{n.value!==null?n.value.setContent(""):(h.value="",f.value=0)},d=T=>{if(n.value!==null)n.value.setContent(n.value.getContent()+T);else{const C=u.modelValue.slice(0,f.value),A=u.modelValue.slice(f.value,h.value.length);h.value=C+T+A,f.value+=T.length}};e({clear:p,setContent:d});const g=()=>{wp.editor.remove(u.editor_id),typeof window.wp.media=="function"&&(wp.media.view.Modal=wp.media.view.Modal.extend({className:"wp-fluent-media-modal"})),wp.editor.initialize(u.editor_id,{mediaButtons:!0,tinymce:{plugins:"fullscreen,lists,link",content_style:gf.isDark()?"*{color:white;} body { background: #11171d; }":"",toolbar1:"formatselect,table,bold,italic,bullist,numlist,link,blockquote,alignleft,aligncenter,alignright,underline,strikethrough,forecolor,removeformat,codeformat,outdent,indent,undo,redo,mediaButton",setup(T){setTimeout(()=>{n.value=T,T.on("ObjectResized",function(I){y()}),T.on("OpenWindow",I=>{const L=I.win.$el;L&&setTimeout(()=>{L.addClass("fluent-cart")})}),jQuery(".wp-media-buttons").css("display","none"),l(T,u.editor_id,u.height),o(T);let C=jQuery(`#${u.editor_id}`);const A=jQuery(C).parents()[0];let M=jQuery(A).find(".ed_button.button.button-small");jQuery(M).click(function(){setTimeout(function(){d(jQuery("#"+u.editor_id).val()),y();const I=jQuery("#wp-link-wrap");I.is(":visible")&&(console.log("Link dialog opened from Text tab"),I.addClass("fluent-cart"))},100)})},100),c("onEditorReady",T),T.on("input cut paste ExecCommand",function(C,A){y()}),T.on("keyup",C=>{(C.key==="Backspace"||C.key==="Delete"||C.key==="x"&&(C.ctrlKey||C.metaKey))&&T.getContent().trim()===""&&y()}),T.addButton("mediaButton",{icon:"image",tooltip:Se("Insert Media"),onclick:()=>{jQuery(".button.insert-media.add_media").click()}})}},quicktags:!0})},y=()=>{let T=wp.editor.getContent(u.editor_id);c("update",T)},m=T=>{if(n!==null)n.value.insertContent(T);else{const C=u.modelValue.slice(0,f.value),A=u.modelValue.slice(f.value,h.value.length);h.value=C+T+A,f.value+=T.length}},_=wr(!1);let S="";const b=()=>{w(),_.value=!0},x=()=>{const T=jQuery(".wp_vue_editor_plain").prop("selectionStart");T.value=T},w=()=>{a.value?S=wp.editor.getContent(u.editor_id):S=h.value,S=S.trim(),S||(S=Se("Nothing to preview"))};return Pw(h,async(T,C)=>{v.value=T,c("update",T)}),(T,C)=>{const A=Ga("el-dialog"),M=Ga("el-tooltip"),I=Ga("el-progress"),L=Ga("el-icon"),P=Ga("el-button"),E=SI("loading");return jt(),ue(Cs,null,[Ae(A,{modelValue:_.value,"onUpdate:modelValue":C[0]||(C[0]=R=>_.value=R),title:T.$t("Preview")},{default:Tr(()=>[_e("div",{innerHTML:Va(S)},null,8,WI)]),_:1},8,["modelValue","title"]),_e("div",UI,[_e("div",YI,[Object.keys(r.shortCodes).length?(jt(),ue("div",$I,[_e("div",XI,[Ae(VI,{data:r.shortCodes,onCommand:m,btnType:"info",btnSize:"small",plain:""},{default:Tr(()=>[Lw(As(T.$t("Add ShortCodes")),1)]),_:1},8,["data"])]),bm(T.$slots,"action")])):Wu("",!0),_e("div",ZI,[n.value!==null?(jt(),Ew(M,{key:0,effect:"dark",content:T.$t("Preview Template"),placement:"top","popper-class":"fct-tooltip"},{default:Tr(()=>[Ae(AI,{bg:"white",onClick:xI(b,["prevent"]),tag:"button",size:"small"},{default:Tr(()=>[Ae(df,{name:"Eye"})]),_:1})]),_:1},8,["content"])):Wu("",!0),bm(T.$slots,"reset_template")])]),_e("div",null,[a.value?(jt(),ue("div",qI,[_e("div",{class:pf(n.value===null?"opacity-0 ":""),style:bI({"min-height":r.height})},[cf((jt(),ue("div",KI,[_e("div",null,[_e("textarea",{onInput:C[1]||(C[1]=()=>{y()}),class:"wp_vue_editor test",id:r.editor_id,value:r.modelValue},null,40,QI)])])),[[E,Va(i).uploadingFile]]),Va(i).uploadingFile?(jt(),ue("div",jI,[Ae(I,{"text-inside":!0,"stroke-width":20,percentage:Va(i).uploadProgress},null,8,["percentage"]),Ae(P,{onClick:C[2]||(C[2]=R=>{Va(s)()})},{default:Tr(()=>[Ae(L,null,{default:Tr(()=>[Ae(Va(MI))]),_:1})]),_:1})])):Wu("",!0)],6)])):(jt(),ue("div",JI,[cf(_e("textarea",{class:"wp_vue_editor wp_vue_editor_plain",onClick:x,"onUpdate:modelValue":C[3]||(C[3]=R=>h.value=R)},null,512),[[wI,h.value]])]))])])],64)}}};/*! *****************************************************************************
